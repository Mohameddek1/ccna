
1. unicast - one source to one destination e.g. email, Internet
2. broadcast - one source to every destinations in LAN e.g. 10.1.1.0/24, ARP, DHCP
    - Routing Protocols - RIPv1, IGRP use broadcast
3. multicast - one source to multiple destinations but not all e.g. video streaming, IPTV
    - Routing Protocols - RIPv2, BGP, OSPF, EIGRP use multicast



=============================
Introduction to IP Multicast
=============================
- IP Multicast is a method of sending Internet Protocol (IP) datagrams to a group of interested receivers in a single transmission. This is more efficient than unicast (one-to-one) or broadcast (one-to-all) transmission methods.

Key Concepts
------------

- **Multicast Group**: A set of receivers that are interested in receiving a particular data stream.
- **Multicast Address**: A special IP address used to identify multicast groups. These addresses range from 224.0.0.0 to 239.255.255.255.
- **Multicast Distribution Tree**: The path that multicast traffic takes from the sender to the receivers.

Benefits of IP Multicast
------------------------

- **Efficiency**: Reduces the amount of bandwidth required for data transmission.
- **Scalability**: Supports a large number of receivers without additional load on the sender.
- **Flexibility**: Can be used for various applications such as video conferencing, online gaming, and stock quotes.

Conclusion
----------

IP Multicast is a powerful technique for efficient data distribution to multiple receivers. Understanding its concepts and benefits is essential for network engineers and IT professionals.

Disadvantages of IP Multicast
--------------------------------
- multicast only Supports UDP traffic, therefore we cannot take advantage like Windowing, Acknowledgements in TCP traffic
- Multicast requires configuration on all devices. its one of the reason why multicast is not widely used


==========================================
Internet Group Management Protocol (IGMP)
==========================================

- IGMP - Internet Group Management Protocol
    - is a network-layer protocol used by hosts (end devices) and routers to establish and manage multicast group memberships. 
    - It allows hosts to inform routers that they are interested in receiving multicast traffic for a specific group, and enables routers to efficiently deliver multicast traffic to interested hosts.
    - between hosts and routers

- IGMP snooping - switch listens to IGMP messages and forwards multicast traffic only to ports with interested receivers

IGMP Versions
--------------
1. IGMPv1: 
    - Hosts send Membership Report messages to join a group.
    - The router periodically sends a General Query to check if hosts are still interested.
    - There is no explicit leave message; routers rely on a timeout to remove hosts.

2. IGMPv2:
    - Hosts can send Leave Group messages to explicitly leave a group.
    - The router sends a Group-Specific Query when a host leaves a group.
    - The router sends a General Query to refresh group memberships.

3. IGMPv3:
    - Supports source-specific multicast (SSM) and allows hosts to specify which sources they want to receive traffic from.
    - Hosts can send Membership Report messages with source lists.
    - Routers can send Group-and-Source-Specific Queries to refresh group memberships.

IGMP Message Types
------------------
1. Membership Query: Sent by the router to check which hosts are interested in a multicast group.
2. Membership Report: Sent by a host to inform the router that it wants to join a multicast group.
3. Leave Group: Sent by a host when it wants to leave a multicast group (only in IGMPv2 and IGMPv3).

 
IGMP Use Cases
--------------
1. IPTV streaming services.
2. Online gaming.
3. Video conferencing.
4. Financial data distribution.


==========================================
Protocol Independent Multicast (PIM)
==========================================
- PIM - Protocol Independent Multicast
    - is a multicast routing protocol used to efficiently forward multicast traffic in an IP network. 
    - It is protocol-independent because it does not depend on a specific unicast routing protocol but can work with any routing method.

Key Components of PIM-SM
----------------------------
1. Rendezvous Point (RP): A central router that initially receives all multicast traffic before forwarding it to receivers.
2. Register and Join Messages: Used by routers to request multicast data from an RP.
3. Shortest Path Tree (SPT) Switchover: After the initial join via RP, routers can switch to a more efficient direct path from the source.

Types of PIM
------------
1. PIM Dense Mode (PIM-DM): 
    - Assumes most receivers are interested in multicast traffic.
    - Uses a flood-and-prune mechanism: initially, all routers receive traffic, and those without interested hosts send prune messages
    - Suitable for small networks with dense multicast group membership.

2. PIM Sparse Mode (PIM-SM): 
    - Assumes few receivers are interested in multicast traffic.
    - Uses a shared tree (Rendezvous Point - RP) approach where multicast traffic is only forwarded if explicitly requested.
    - Suitable for large networks with sparse multicast group membership.

3. PIM Sparse-Dense Mode (PIM-SDM): 
    - Combines features of PIM-DM and PIM-SM.

4. PIM source-specific multicast (PIM-SSM): 
    - Supports IGMPv3 and allows receivers to specify both the multicast group and the specific source from which they want traffic.
    - Uses a shared tree approach with a specific source.
    - Eliminates the need for a Rendezvous Point (RP).

PIM Use Cases
-------------
1. Large-scale video streaming (e.g., YouTube Live, IPTV).
2. Financial market data updates.
3. Real-time collaboration tools (e.g., Zoom, Microsoft Teams).

3. IGMP vs PIM: Key Differences
|Feature	         |       IGMP	                           |         PIM
---------------------|-----------------------------------------|---------------------------------------------------
|Function	         |   Manages multicast group memberships   |	 Routes multicast traffic across a network
|Where it Operates   |	 End-hosts and local routers	       |     Between multicast routers
|Scope	             |   Local subnet	                       |     Larger networks
|Dependency	         |   Works with PIM for routing	           |     Works with IGMP to determine interested hosts


- IGMP is responsible for group membership management at the subnet level, allowing hosts to join or leave multicast groups.
- PIM ensures efficient multicast traffic routing across a network, using modes like PIM-DM, PIM-SM, and PIM-SSM.
- Together, IGMP and PIM enable scalable, efficient, and controlled multicast communication, making them crucial for real-time applications like IPTV, video conferencing, and financial data distribution.

==========================================
IP Addressing in Multicast
==========================================
- Multicast IP addresses are part of Class D in the IPv4 addressing scheme, which ranges from:
`224.0.0.0 to 239.255.255.255`

1. 224.0.0.0 - 224.0.0.255	--> Local Network Control (e.g., routing protocols like OSPF, RIP v2)
2. 224.0.1.0 - 238.255.255.255	--> Global Internet Multicast (used across multiple networks)
3. 239.0.0.0 - 239.255.255.255	--> Private/Local Scope (not routed on the internet, similar to private IPs)

i. Local Network Control Block (224.0.0.0 - 224.0.0.255) - (224.0.0.0/24) - Multicast ip packets in this range cant be forwarded between networks or subnets e.g.
224.0.0.1 - All hosts
224.0.0.2 - All multicast routers
224.0.0.5-6 - OSPF
224.0.0.9 - RIP v2
224.0.0.10 - EIGRP
224.0.0.18 - VRRP

ii. Internetwork Control Block (224.0.1.0-224.0.1.255) - (224.0.1.0/24) - Multicast ip packets in this range can be forwarded between networks or subnets e.g.
224.0.1.39 - Cisco-RP-Announce
224.0.1.40 - Cisco-RP-Discovery

iii. Local Network Block (239.0.0.0-239.255.255.255) - (239.0.0.0/8) - we can use the IP addresses in this range in our local network

===============================================
Mapping IP Multicast Addresses to MAC Addresses
===============================================
- Since Ethernet frames use MAC addresses, a special mapping is used to convert a multicast IP address to a multicast MAC address.

Multicast MAC Address Range: `01:00:5E:xx:xx:xx`
Conversion Process:
- The first 25 bits are fixed (01:00:5E).
- The next 23 bits are derived from the last 23 bits of the multicast IP.
- 01 ‚Üí Indicates a multicast MAC address.
- 00:5E ‚Üí Assigned to IANA (Internet Assigned Numbers Authority) for IPv4 multicast.
Example:
---------
IP Multicast Address: 224.1.1.1
Convert to binary: 11100000.00000001.00000001.00000001
Keep last 23 bits: 00000001.00000001.00000001
Convert to MAC: 01:00:5E:01:01:01



===================================
Commands
===================================
- Enable Multicast Routing Globally:
    `Router(config)# ip multicast-routing`

- Configure PIM Sparse Mode on an Interface:
    `Router(config-if)# ip pim sparse-mode`

- Configure PIM Dense Mode on an Interface:
    `Router(config-if)# ip pim dense-mode`

- Configure PIM Sparse-Dense Mode on an Interface:
    `Router(config-if)# ip pim sparse-dense-mode`

- Verify Multicast Routing Table:
    `Router# show ip mroute`

- Check PIM Neighbors:
    `Router# show ip pim neighbor`

- Changing IGMP versions:
    `Router(config)# int fa0/0`
    `Router(config)# ip igmp version 3`

- joining a multicast group:
    `Router(config)# int fa0/0`
    `Router(config)# ip igmp join-group 

- Debug IGMP:
    `Router# debug ip igmp`

- IGMP version 3:
    `Router(config)# ip igmp version 3`
    `Router(config-if)# ip igmp join-group 239.1.1.99 source 4.1.1.1`

==================================================================
`commands for filtering multicast traffic using IGMP access lists`
==================================================================
    R1(config)#ip Access-list standard moha-filter
    R1(config-std-nacl)#deny host 239.1.1.1
    R1(config-std-nacl)#permit host 238.1.1.100
    R1(config-std-nacl)#permit host 238.1.1.200
    R1(config-std-nacl)#int fa0/0
    R1(config-if)#ip igmp access-group moha-filter
    R1(config-if)#no sh
    R1(config-if)#end

    R2(config-if)#ip igmp join-group 239.1.1.1
    R2(config)#no ip routing
    R2(config)#int fa0/0
    R2(config-if)#ip add 10.1.1.101 255.255.255.0
    R2(config-if)#ip igmp version 3
    R2(config-if)#ip igmp join-group 239.1.1.1 source 4.1.1.1


===================================
IGMP Snooping
===================================
- IGMP snooping is a feature that listens to IGMP messages between hosts and routers and uses this information to forward multicast traffic only to ports with interested receivers. This reduces unnecessary multicast traffic on the network.

`commands`
    
-Router1(config)# ip multicast-routing
-Router1(config)# interface fa0/0
-Router1(config-if)# ip pim sparse-mode
-Router1(config-if)# exit
-Router1(config)# interface fa0/0
-Router1(config-if)# ip igmp querier
-Router1(config-if)# exit

Router2(config)# interface fa0/0
Router2(config-if)# ip igmp join-group 239.255.255.1
Router2(config-if)# exit

-Switch(config)# ip igmp snooping

Enable IGMP Snooping Querier (if no router querier is present):
-Switch(config)# ip igmp snooping querier

Verify IGMP Snooping Status:
-Switch# show ip igmp snooping

Check IGMP Group Memberships:
-Switch# show ip igmp snooping groups



===============================
Multicast Routing
===============================
- Multicast routing is the process of forwarding multicast packets from a source to multiple receivers efficiently. It allows one-to-many and many-to-many communication by delivering packets only to devices that have explicitly joined the multicast group.

- to forward unicast packets router checks the destination IP address, check routing Table and finds out the next hop addresses to forward the packets
- we use unicast routing to route IPv4/IPv6 packets in networks with static routing or dynamic protocols

- the routing table we refer is unicast routing table, but doesnot carry any information on multicast class D addresses

multicast routing protocols
---------------------------
1. PIM - Protocol Independent Multicast
2. DVMRP - Distance Vector Multicast Routing Protocol
3. MOSPF - Multicast Open Shortest Path First

==========================================
Protocol Independent Multicast (PIM)
==========================================
- PIM - Protocol Independent Multicast
    - is a multicast routing protocol used to efficiently forward multicast traffic in an IP network. 
    - It is protocol-independent because it does not depend on a specific unicast routing protocol but can work with any routing method.

Key Components of PIM-SM
----------------------------
1. Rendezvous Point (RP): A central router that initially receives all multicast traffic before forwarding it to receivers.
2. Register and Join Messages: Used by routers to request multicast data from an RP.
3. Shortest Path Tree (SPT) Switchover: After the initial join via RP, routers can switch to a more efficient direct path from the source.

Types of PIM
------------
1. PIM Dense Mode (PIM-DM): 
    - Assumes most receivers are interested in multicast traffic.
    - Uses a flood-and-prune mechanism: initially, all routers receive traffic, and those without interested hosts send prune messages
    - Suitable for small networks with dense multicast group membership.
    - to prevent multicast forwarding loops, ip multicast always perform an RPF(Reverse Path Forwarding) check
    - when router receive same traffic from multiple neighbors, then it checks the unicast routing table to find the best path to forward the multicast traffic
    - Best for small, high-bandwidth networks where most routers need multicast.
    - Ideal for LANs where flooding is not a major issue.

Step 1: Enable Multicast Routing on All Routers
`conf t
ip multicast-routing
exit`
Step 2: Configure PIM Dense Mode on All Interfaces
R1
`conf t
interface Gi0/0  # Interface to Video Server
 ip pim dense-mode
exit
interface Gi0/1  # Interface to R2
 ip pim dense-mode
exit`
R2
`conf t
interface Gi0/0  # Interface to R1
 ip pim dense-mode
exit
interface Gi0/1  # Interface to R3
 ip pim dense-mode
exit
`
R3
`conf t
interface Gi0/0  # Interface to R2
 ip pim dense-mode
exit
interface Gi0/1  # Interface to PC
 ip pim dense-mode
exit
`
Step 3: Join the Multicast Group on R3
`conf t
interface Gi0/1
 ip igmp join-group 239.1.1.1
exit
`
Verification Commands
`show ip pim neighbor
show ip igmp groups
show ip mroute
`

2. PIM Sparse Mode (PIM-SM): 
    - Assumes few receivers are interested in multicast traffic.
    - Sparse Mode use a controlled registration process using **PIM Register messages** to inform the Rendezvous Point (RP) about the source.
    - sparse mode uses a routers explicitly request multicast traffic using **PIM Join messages**.
    - R3(receiver) then sends a **PIM Prune** to RP to stop duplicate traffic from the Shared Tree.
    - Uses a shared tree (Rendezvous Point - RP) approach where multicast traffic is only forwarded if explicitly requested.
    - SPT Optimization allows multicast routers to switch from the RP-based Shared Tree ((*,G)) to a direct Shortest Path Tree ((S,G)).

    - RP acts as a central meeting point between senders (Video Server on R1) and receivers (PC on R3).
    - Without an RP, routers would not know where to send join requests and would fail to establish the multicast tree
    - Suitable for large networks with sparse multicast group membership.

    - To optimize, R3 sends a PIM Join directly to the source (R1) to get the shortest path.
    - Once the direct path (SPT) is built, R3 stops using the RP and prunes it off.`

Step 1: Enable Multicast Routing on All Routers
`conf t
ip multicast-routing
exit`
Step 2: Configure PIM Sparse Mode on All Interfaces
R1
`conf t
interface Gi0/0  # Interface to Video Server
 ip pim sparse-mode
exit
interface Gi0/1  # Interface to R2
 ip pim sparse-mode
exit`
R2
`conf t
interface Gi0/0  # Interface to R1
 ip pim sparse-mode
exit
interface Gi0/1  # Interface to R3
 ip pim sparse-mode
exit`
R3
`conf t
interface Gi0/0  # Interface to R2
 ip pim sparse-mode
exit
interface Gi0/1  # Interface to PC
 ip pim sparse-mode
exit`
Step 3: Configure RP (Rendezvous Point) on R2
`conf t
ip pim rp-address 10.1.1.1  # Use R2's Loopback as RP
interface Loopback0
 ip address 10.1.1.1 255.255.255.255
 ip pim sparse-mode
exit`
Step 4: Enable IGMP on the PC Interface (R3)
- To allow the PC to join the multicast group:
`conf t
interface Gi0/1
 ip igmp join-group 239.1.1.1
exit`
Verifications
`show ip pim neighbor
show ip igmp groups
show ip mroute
`
Configuration to Disable SPT Switchover
`Router(config)# interface GigabitEthernet0/1
Router(config-if)# ip pim sparse-mode
Router(config)# ip pim spt-threshold infinity group-list 239.1.1.1
`

PIM Auto-RP (Auto Rendezvous Point)
-----------------------------------
- 2 ways to selects RP in PIM-SM
    1. Manually configure RP on all routers
    2. Use Auto-RP to automate the RP selection process
- So dynamic RP has 2 ways
    1. Auto-RP  -  is a way of advertising the IP address for RP
    2. BSR - Bootstrap Router
- Automates RP Selection ‚Äì No need to manually configure RP on every router.
- Scalability ‚Äì Multiple RPs can be assigned dynamically.
- Redundancy ‚Äì If an RP fails, a backup RP can take over.
- Simplifies Configuration ‚Äì Routers automatically learn the RP.

üîπ How Auto-RP Works
Auto-RP requires two key roles:
1Ô∏è‚É£ RP-Candidate ‚Üí Advertises itself as a possible RP.
2Ô∏è‚É£ Mapping Agent (MA) ‚Üí Listens to RP-Candidates and selects the RP.
- mapping agent uses the multicast group 234.0.1.39
- the information is sent to the multicast group 234.0.1.40 to directly connected routers

  (Source)
     |
    R1 -- RP-Candidate
     |        \
    R2 ---- R3 (Mapping Agent)
     |        /
    R4 ---- Receiver (PC)

**Configuration for Auto-RP**
‚úÖ Step 1: Configure PIM-SM on All Routers
`R1(config)# interface GigabitEthernet0/1  # Connected to Video Server
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R2(config)# interface GigabitEthernet0/1  # Connected to R1
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/2  # Connected to R3
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R3(config)# interface GigabitEthernet0/1  # Connected to R2
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/2  # Connected to PC
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R4(config)# interface GigabitEthernet0/1  # Connected to R1
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
`
‚úÖ Step 2: Configure R4 as the RP Candidate
`R4(config)# interface Loopback0  # RP Address
R4(config-if)# ip address 4.4.4.4 255.255.255.255
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
# Advertise R4 as RP Candidate
R4(config)# ip pim send-rp-announce Loopback0 scope 16
`
‚úÖ Step 3: Configure R1 as the Mapping Agent
`R2(config)# ip pim send-rp-discovery scope 16
`
‚úÖ Step 4: Configure R2 with PIM and RP Listener
`# Configure PIM Sparse Mode on R2
R2(config)# interface GigabitEthernet0/0
R2(config-if)# ip address 192.168.12.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config)# interface GigabitEthernet0/1
R2(config-if)# ip address 192.168.23.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
# Enable RP Listener to forward Auto-RP messages
R2(config)# ip pim rp-listener
`

‚úÖ Step 5: Enable IGMP on the PC‚Äôs Router (R3)
`R3(config)# interface GigabitEthernet0/2  # Connected to PC
R3(config-if)# ip igmp join-group 239.1.1.1
R3(config-if)# exit
`

Verification Commands
`show ip pim rp mapping
show ip pim rp
show ip mroute
`

‚úÖ Uses RP-Announce (224.0.1.39) and RP-Discovery (224.0.1.40).
‚úÖ Needs RP-Candidate and Mapping Agent roles.
‚úÖ Simplifies multicast deployment in large networks.

* Auto-RP when used in sparse mode:
- use rp-listener in R2
- or use sparse-dense-mode

PIM Bootstrap Router (BSR)
-----------------------------
- is a method for dynamically selecting and distributing the Rendezvous Point (RP) in PIM Sparse Mode (PIM-SM) networks. Instead of manually configuring an RP for each multicast group, BSR automates RP selection and distribution.

üöÄ How BSR Works
- Candidate RPs (C-RPs) advertise themselves to the BSR.
- BSR collects the C-RP information and creates an RP set.
- BSR floods the RP set to all PIM routers using special PIM messages.
- Routers choose the RP from the RP set based on hash calculations or group-specific RP assignments.

**üìå Configuration of BSR in a Network**
üìç Topology
[ Video Server ] -- (R1) -- (R2) -- (R3) -- [ PC ]
                 |
                (R4)  -->  Candidate RP

‚úÖ Step 1: Enable PIM Sparse Mode on All Routers
`R1(config)# interface GigabitEthernet0/1  # Connected to Video Server
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/2  # Connected to R2
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R2(config)# interface GigabitEthernet0/1  # Connected to R1
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/2  # Connected to R3
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R3(config)# interface GigabitEthernet0/1  # Connected to R2
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/2  # Connected to PC
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R4(config)# interface GigabitEthernet0/1  # Connected to R1
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
`
‚úÖ Step 2: Configure R4 as the Candidate RP
`# Configure Loopback interface for RP identity
R4(config)# interface Loopback0
R4(config-if)# ip address 4.4.4.4 255.255.255.255
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
# Advertise R4 as the Candidate RP for multicast groups
R4(config)# ip pim rp-candidate Loopback0 group-list 239.1.1.1
R4(config)# ip pim rp-candidate Loopback0 group-list 239.2.2.2
`
‚úÖ Step 3: Configure R1 as the Bootstrap Router (BSR)
`# Configure Loopback interface for BSR identity
R1(config)# interface Loopback0
R1(config-if)# ip address 1.1.1.1 255.255.255.255
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
# Configure R1 as BSR
R1(config)# ip pim bsr-candidate Loopback0 0
`
- The 0 at the end of the BSR command means R4 has the highest priority (0 is the best).
- All routers in the domain will listen for BSR messages to dynamically discover RPs.

‚úÖ Step 4: Enable IGMP Join on R3 for Testing
`R3(config)# interface GigabitEthernet0/2  # Connected to PC
R3(config-if)# ip igmp join-group 239.1.1.1
R3(config-if)# ip igmp join-group 239.2.2.2
R3(config-if)# exit
`
‚úÖ Step 5: Verification Commands
`# Check RP Mapping (Should show dynamically assigned RPs)
show ip pim rp mapping  
# Verify which router is the BSR
show ip pim bsr-router  
# Verify multicast routing table
show ip mroute  
`

**Why Use BSR Instead of Static RP?**
- Automates RP Discovery ‚Äì No need to manually configure RP on each router.
- Fault Tolerance ‚Äì If an RP fails, another candidate RP can take over.
- Scalability ‚Äì Works better in large networks with multiple multicast groups.


3. PIM Sparse-Dense Mode (PIM-SDM): 
    - Combines features of PIM-DM and PIM-SM.
‚úÖ Step 1: Configure PIM Sparse-Dense Mode on All Routers
`# R1 (Connected to Video Server)
R1(config)# interface GigabitEthernet0/1  
R1(config-if)# ip pim sparse-dense-mode
R1(config-if)# exit
# R2 (Connected to R1 and R3)
R2(config)# interface GigabitEthernet0/1  
R2(config-if)# ip pim sparse-dense-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/2  
R2(config-if)# ip pim sparse-dense-mode
R2(config-if)# exit
# R3 (Connected to R2 and PC)
R3(config)# interface GigabitEthernet0/1  
R3(config-if)# ip pim sparse-dense-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/2  
R3(config-if)# ip pim sparse-dense-mode
R3(config-if)# exit
# R4 (Connected to R1, RP Candidate)
R4(config)# interface GigabitEthernet0/1  
R4(config-if)# ip pim sparse-dense-mode
R4(config-if)# exit
`
‚úÖ Step 2: Configure R4 as the RP Candidate
`# R4 - Create Loopback Interface for RP
R4(config)# interface Loopback0  
R4(config-if)# ip address 4.4.4.4 255.255.255.255
R4(config-if)# ip pim sparse-dense-mode
R4(config-if)# exit
# Advertise R4 as RP Candidate
R4(config)# ip pim send-rp-announce Loopback0 scope 16
`
‚úÖ Step 3: Configure R1 as the Auto-RP Mapping Agent
`# R1 - Enable Auto-RP Mapping Agent
R1(config)# ip pim send-rp-discovery scope 16
`
‚úÖ Step 4: Configure R2 with Sparse-Dense mode
`# Configure PIM Sparse-Dense Mode on R2
R2(config)# interface GigabitEthernet0/0
R2(config-if)# ip address 192.168.12.2 255.255.255.0
R2(config-if)# ip pim sparse-dense-mode
R2(config)# interface GigabitEthernet0/1
R2(config-if)# ip address 192.168.23.2 255.255.255.0
R2(config-if)# ip pim sparse-dense-mode
`
‚úÖ Step 5: Enable IGMP on R3 (PC‚Äôs Router)
`# Configure R3 to join multicast group 239.1.1.1
R3(config)# interface GigabitEthernet0/2  
R3(config-if)# ip igmp join-group 239.1.1.1
R3(config-if)# exit
`
‚úÖ Verification Commands
`# Check RP mappings
show ip pim rp mapping  
# Verify RP information
show ip pim rp  
# Verify multicast routing table
show ip mroute  
`

- we can use RP, Auto-RP and no RP in PIM-SDM





==============================
PIM Designated Router (DR)
==============================
- PIM Designated Router (DR) is responsible for forwarding multicast traffic from hosts to the multicast network on a multi-access network (like Ethernet).
- used in sparse mode

**Why do we need a DR?**
- On LANs (multi-access networks), multiple routers may be connected to the same subnet.
- To avoid duplicate multicast traffic, PIM elects one router as the DR to manage multicast traffic.

**üîπ PIM DR Election Process**
1Ô∏è‚É£ All PIM-enabled routers on the LAN send Hello messages.
2Ô∏è‚É£ Router with the highest IP address or highest priority is elected as the DR.
3Ô∏è‚É£ The DR is responsible for sending Register messages to the RP (in PIM-SM) or forwarding traffic in PIM-DM.

**üìç LAB Example: PIM Designated Router (DR) Setup**
üìå Topology
       (R1) ---- (R2)
         |         |
         |         |
       (PC1)    (PC2)
R1 and R2 are in the same LAN (connected to PC1 and PC2).
R1 and R2 will compete for DR election.
R1 will be forced to become the DR by setting a higher priority.

‚úÖ Step 1: Enable PIM Sparse Mode
üìå Configuration for R1 (Higher Priority to be DR)
`R1(config)# interface GigabitEthernet0/0  # Connected to LAN
R1(config-if)# ip address 192.168.1.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# ip pim dr-priority 10  # Higher priority (Default is 1)
R1(config-if)# exit
`
üìå Configuration for R2 (Lower Priority)
`R2(config)# interface GigabitEthernet0/0  # Connected to LAN
R2(config-if)# ip address 192.168.1.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
`
‚úÖ Step 2: Verification Commands
üìå Check DR Election
`show ip pim interface detail
`
Expected Output on R1:
`Interface: GigabitEthernet0/0, DR: 192.168.1.1`
Expected Output on R2:
`Interface: GigabitEthernet0/0, DR: 192.168.1.1`



==================================
üìå PIM Assert Mechanism
==================================
- When multiple routers are connected to the same multi-access network (such as Ethernet or a switch) and receive the same multicast traffic from the source, they will compete to forward multicast traffic.
- PIM Assert is a mechanism used to resolve conflicts when multiple routers claim to be the DR for a multicast group.
- PIM Assert Mechanism is used to prevent duplicate multicast packets from being sent over the network.
- The router with the lowest administrative distance (AD) and highest metric to the source wins the election and becomes the designated forwarder.

**üìç Example Lab: PIM Assert Mechanism in Action**
üîπ Topology

    (Video Server) 
          |
      (Switch)
      /      \
    R1       R2
      \      /
      (Receiver - PC)
R1 and R2 are connected to the same switch and will compete to forward multicast packets.
R1 and R2 receive multicast traffic from the Video Server.
PIM Assert will determine which router forwards multicast packets to the PC.

‚úÖ Step 1: Configure PIM Sparse Mode on R1, R2, and PC
üìå Configuration for R1
`R1(config)# interface GigabitEthernet0/0  # Connected to Switch
R1(config-if)# ip address 192.168.1.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/1  # Connected to PC
R1(config-if)# ip address 192.168.2.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
`

üìå Configuration for R2
`R2(config)# interface GigabitEthernet0/0  # Connected to Switch
R2(config-if)# ip address 192.168.1.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/1  # Connected to PC
R2(config-if)# ip address 192.168.2.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
`

üìå Configuration for the PC (Multicast Receiver)
`R3(config)# interface GigabitEthernet0/0  # Connected to Switch
R3(config-if)# ip address 192.168.1.3 255.255.255.0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/1  # Connected to PC
R3(config-if)# ip address 192.168.2.3 255.255.255.0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
# Join multicast group
R3(config)# interface GigabitEthernet0/1
R3(config-if)# ip igmp join-group 239.1.1.1
R3(config-if)# exit
`
‚úÖ Step 2: Configure RP (Optional)
`R1(config)# interface Loopback0
R1(config-if)# ip address 1.1.1.1 255.255.255.255
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
# Configure RP
R1(config)# ip pim rp-candidate Loopback0
`
‚úÖ Step 3: Trigger the PIM Assert Mechanism
- Send multicast traffic from the Video Server (connected to the switch).
- Both R1 and R2 will receive the multicast stream.
- PIM Assert will determine which router should forward multicast traffic to R3 (PC).
- The losing router will stop forwarding multicast packets to avoid duplication.

‚úÖ Step 4: Verification Commands
`# Check which router won the PIM Assert election
show ip pim interface detail  
# Check the multicast routing table
show ip mroute  
# Verify which router is the RP
show ip pim rp mapping  
`

=======================================
üìå Reverse Path Forwarding (RPF)
=======================================
- Reverse Path Forwarding (RPF) is a mechanism used in multicast routing to prevent loops and ensure that multicast packets are forwarded along the shortest path.


**How RPF Works**
- When a router receives a multicast packet, it checks the source IP address.
- The router looks up the best path back to the source (via the unicast routing table).
- If the packet is received on the correct incoming interface, it passes the RPF check and is forwarded.
- If the packet arrives on the wrong interface, it fails the RPF check and is dropped to prevent loops.

**üìç Example Lab**
üîπ Topology
     (Multicast Source - Video Server)
                 |
                R1
              /    \
            R2      R3
              \    /
               R4 (Receiver - PC)
R1 is the multicast source sender (Video Server).
R4 is the multicast receiver (PC).
R2 and R3 are intermediate routers.
PIM Sparse Mode is used, and RPF ensures correct forwarding of multicast packets.

‚úÖ Step 1: Configure PIM Sparse Mode on All Routers
üìå Configuration for R1 (Multicast Source)
`R1(config)# interface GigabitEthernet0/0  # Connected to R2
R1(config-if)# ip address 192.168.1.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/1  # Connected to R3
R1(config-if)# ip address 192.168.2.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
`
üìå Configuration for R2
`R2(config)# interface GigabitEthernet0/0  # Connected to R1
R2(config-if)# ip address 192.168.1.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/1  # Connected to R4
R2(config-if)# ip address 192.168.3.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
`
üìå Configuration for R3
`R3(config)# interface GigabitEthernet0/0  # Connected to R1
R3(config-if)# ip address 192.168.2.2 255.255.255.0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/1  # Connected to R4
R3(config-if)# ip address 192.168.4.2 255.255.255.0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
`
üìå Configuration for R4 (Multicast Receiver)
`R4(config)# interface GigabitEthernet0/0  # Connected to R2
R4(config-if)# ip address 192.168.3.4 255.255.255.0
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
R4(config)# interface GigabitEthernet0/1  # Connected to R3
R4(config-if)# ip address 192.168.4.4 255.255.255.0
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
# Join multicast group for testing
R4(config)# interface GigabitEthernet0/1
R4(config-if)# ip igmp join-group 239.1.1.1
R4(config-if)# exit
`
‚úÖ Step 2: Configure RP (Rendezvous Point)
`R1(config)# interface Loopback0
R1(config-if)# ip address 1.1.1.1 255.255.255.255
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# ip pim rp-candidate Loopback0

‚úÖ Step 3: Trigger the RPF Check`
- Send multicast traffic from R1 (Video Server).
- R2 and R3 receive the multicast packets.
- Each router performs an RPF check to determine the correct forwarding path.
- RPF ensures that multicast packets follow the correct shortest path back to the source.

‚úÖ Step 4: Verification Commands
`# Check multicast routing table
show ip mroute  
# Verify which interface passes the RPF check
show ip rpf <source-IP>  
# Check which router is the RP
show ip pim rp mapping  
`

- changing best route through static configuration
`ip mroute <source-IP> <group-IP> <next-hop>`

===========================================================
üìå Reverse Path Forwarding (RPF) Using Tunnel Interface
===========================================================
-  in scenarios where the RPF check fails due to asymmetric routing (e.g., different incoming and outgoing paths), a tunnel interface can be used to create a virtual path back to the multicast source.

üõ† Use Case for RPF with Tunnel
---------------------------------
- Multicast packets are dropped due to failing the RPF check.
- Multicast traffic must be tunneled through a network that doesn‚Äôt support multicast.
- Asymmetric routing issues prevent correct forwarding.

üìç Example Lab: RPF Using Tunnel Interface
--------------------------------------------
üîπTopology
   (Multicast Source - Video Server)
               |
              R1
             /   \
           R2     R3
             \   /
              R4  (Receiver - PC)

- Multicast source (Video Server) sends traffic to R1.
- R4 (Receiver) wants to receive multicast but has an incorrect RPF check.
- A tunnel interface is created between R4 and R1 to solve the issue.

‚úÖ Step 1: Configure PIM Sparse Mode on All Routers
üìå Configuration for R1 (Multicast Source)
`R1(config)# interface GigabitEthernet0/0  # Connected to R2
R1(config-if)# ip address 192.168.1.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/1  # Connected to R3
R1(config-if)# ip address 192.168.2.1 255.255.255.0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
`
üìå Configuration for R2
`R2(config)# interface GigabitEthernet0/0  # Connected to R1
R2(config-if)# ip address 192.168.1.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/1  # Connected to R4
R2(config-if)# ip address 192.168.3.2 255.255.255.0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
`
üìå Configuration for R3
`R3(config)# interface GigabitEthernet0/0  # Connected to R1
R3(config-if)# ip address 192.168.2.2 255.255.255.0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/1  # Connected to R4
R3(config-if)# ip address 192.168.4.2 255.255.255.0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
`
üìå Configuration for R4 (Multicast Receiver)
`R4(config)# interface GigabitEthernet0/0  # Connected to R2
R4(config-if)# ip address 192.168.3.4 255.255.255.0
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
R4(config)# interface GigabitEthernet0/1  # Connected to R3
R4(config-if)# ip address 192.168.4.4 255.255.255.0
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
# Join multicast group for testing
R4(config)# interface GigabitEthernet0/1
R4(config-if)# ip igmp join-group 239.1.1.1
R4(config-if)# exit
`
‚úÖ Step 2: Configure the Tunnel Between R1 and R4
- Since R4 is failing the RPF check, we create a GRE tunnel to fix the issue.
üìå Configuration for R1 (Tunnel Source)
`R1(config)# interface Tunnel0
R1(config-if)# ip address 10.10.10.1 255.255.255.252
R1(config-if)# tunnel source GigabitEthernet0/0
R1(config-if)# tunnel destination 192.168.3.4
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
`
üìå Configuration for R4 (Tunnel Destination)
`R4(config)# interface Tunnel0
R4(config-if)# ip address 10.10.10.2 255.255.255.252
R4(config-if)# tunnel source GigabitEthernet0/0
R4(config-if)# tunnel destination 192.168.1.1
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
`
‚úÖ Step 3: Update R4‚Äôs Routing to Use the Tunnel for RPF
- R4‚Äôs RPF check was failing because it saw traffic coming from an incorrect interface.
- Now we override the RPF check to use the tunnel.
`R4(config)# ip mroute 10.10.10.1 255.255.255.255 Tunnel0
`
‚úÖ Step 4: Verification Commands
`# Check the multicast routing table
show ip mroute  
# Verify RPF check (should show Tunnel0 now)
show ip rpf 10.10.10.1  
# Check if the tunnel is up
show ip interface brief  
# Check PIM neighbors over the tunnel
show ip pim neighbor  
`
**üî• Summary**
- RPF prevents multicast loops by checking the source of multicast traffic.
- When RPF fails due to asymmetric routing, multicast packets get dropped.
- Creating a GRE tunnel allows us to override the RPF check.
- We then configure a static multicast route (ip mroute) to force multicast traffic through the tunnel.

======================================================================
üìå PIM Anycast RP Using MSDP (Multicast Source Discovery Protocol)
======================================================================
- PIM Anycast RP is a method used in multicast networks to provide redundancy and load balancing for the Rendezvous Point (RP). It allows multiple routers to act as RPs for the same multicast group while keeping them synchronized using Multicast Source Discovery Protocol (MSDP).

üîπ Why Use PIM Anycast RP?
-----------------------------
- Redundancy: If one RP fails, another RP can continue forwarding multicast traffic.
- Load Balancing: Different receivers can use different RPs, reducing load on any single RP.
- Fast Convergence: Ensures quick recovery in case of failures.

üìç Example Lab: Configuring PIM Anycast RP with MSDP
-----------------------------------------------------
üîπTopology
   (Multicast Source - Video Server)
                |
               R1 (RP1)  <--- MSDP --->  R2 (RP2)
              /   \                    /   \
            R3     R4                 R5    R6
                (Receiver - PC)
R1 and R2 are Anycast RPs (they share the same RP address).
MSDP is configured between R1 and R2 to synchronize multicast sources.
R3, R4, R5, and R6 are PIM routers forwarding multicast traffic.

‚úÖ Step 1: Configure PIM Sparse Mode on All Routers
üìå Configuration on All Routers (R1 - R6)
`# Enable PIM on all interfaces where multicast is needed
R1(config)# interface GigabitEthernet0/0
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R2(config)# interface GigabitEthernet0/0
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R3(config)# interface GigabitEthernet0/0
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R4(config)# interface GigabitEthernet0/0
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
R5(config)# interface GigabitEthernet0/0
R5(config-if)# ip pim sparse-mode
R5(config-if)# exit
R6(config)# interface GigabitEthernet0/0
R6(config-if)# ip pim sparse-mode
R6(config-if)# exit
`
‚úÖ Step 2: Configure Anycast RP on R1 & R2
- Assign the same Anycast RP address (10.10.10.10) to both R1 & R2.
- Use Loopback interfaces as RP identity.
üìå Configuration on R1 (RP1)
`R1(config)# interface Loopback0
R1(config-if)# ip address 10.10.10.10 255.255.255.255
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
# Advertise RP
R1(config)# ip pim rp-address 10.10.10.10
`
üìå Configuration on R2 (RP2)
`R2(config)# interface Loopback0
R2(config-if)# ip address 10.10.10.10 255.255.255.255
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
# Advertise RP
R2(config)# ip pim rp-address 10.10.10.10
`
üîπ Both R1 & R2 use the same RP address (10.10.10.10), which is what makes it an Anycast RP.

‚úÖ Step 3: Configure MSDP Between R1 & R2
- MSDP synchronizes multicast sources between the two RPs.
- Each RP registers sources and informs the other RP about them.
üìå Configuration on R1
`R1(config)# ip msdp peer 192.168.1.2 connect-source Loopback0
R1(config)# ip msdp originator-id Loopback0
`
üîπ MSDP peer is R2 (192.168.1.2)
üîπ The originator ID is the RP address (Loopback0)

üìå Configuration on R2
`R2(config)# ip msdp peer 192.168.1.1 connect-source Loopback0
R2(config)# ip msdp originator-id Loopback0
`
üîπ MSDP peer is R1 (192.168.1.1)

‚úÖ Step 4: Configure IGMP Join on R6 (Receiver)
- To test multicast, we configure R6 to join a multicast group.
üìå Configuration on R6 (Receiver)
`R6(config)# interface GigabitEthernet0/1
R6(config-if)# ip igmp join-group 239.1.1.1
R6(config-if)# exit
`

‚úÖ Step 5: Verification Commands
`show ip pim rp mapping
show ip msdp peer
show ip mroute
show ip igmp groups
`

**üî• Summary**
‚úÖ PIM Anycast RP provides redundancy and load balancing by allowing multiple routers to serve as RP for the same multicast group.
‚úÖ MSDP (Multicast Source Discovery Protocol) allows multiple RPs to share multicast source information dynamically.
‚úÖ By configuring MSDP between R1 and R2, we ensure that multicast receivers can always reach the source, even if one RP fails.
üîπ This setup is widely used in large multicast networks such as IPTV, live video streaming, and financial market data distribution. üöÄ



====================================================
PIM Bidirectional Mode (PIM-BiDir)
====================================================
- PIM Bidirectional (BiDir) mode is a multicast routing protocol that allows many-to-many communication without the need for source-specific trees (S,G entries). Unlike PIM Sparse Mode, where traffic flows from source to the RP and then to receivers, PIM-BiDir enables two-way traffic flow through the RP without registering sources dynamically.
- in PIM-BiDir routers will not send PIM Register messages to the RP for source registration becouse we dont want (S, G) entries in PIM-BiDir
- There is no RPF check therefore it uses concept of Designated Forwarder (DF) to prevent loops

üîπ Key Features of PIM-BiDir
-------------------------------
‚úî Efficient Many-to-Many Communication (e.g., stock market feeds, video conferencing)
‚úî Eliminates Source Registration (No need for Shortest Path Tree (SPT) switching)
‚úî Traffic Flows Directly Between Receivers (No SPT transition needed)
‚úî One Shared Tree (RPT) for All Sources

üìç Example Lab: Configuring PIM-BiDir
----------------------------------------
üîπTopology
    (Multicast Source - Video Server)
                 |
                R1 (RP)
                  /   \
                R2     R3
                  \   /
                R4 (Receiver - PC)

- R1 is the RP (Rendezvous Point).
- R2 & R3 forward multicast traffic bidirectionally.
- R4 is a multicast receiver.

‚úÖ Step 1: Enable PIM BiDir on All Routers
üìå Configure PIM BiDir on Interfaces
`# Enable PIM sparse mode first
R1(config)# interface GigabitEthernet0/1  # Connected to R2
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/2  # Connected to R3
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R2(config)# interface GigabitEthernet0/1  # Connected to R1
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/2  # Connected to R4
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R3(config)# interface GigabitEthernet0/1  # Connected to R1
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/2  # Connected to R4
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R4(config)# interface GigabitEthernet0/1  # Connected to R2 and R3
R4(config-if)# ip pim sparse-mode
R4(config-if)# exit
`
Enable PIM-BiDir on All Routers and Interfaces
`# R1 (RP)
R1(config)# interface GigabitEthernet0/1
R1(config-if)# ip pim bidir-enable
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/2
R1(config-if)# ip pim bidir-enable
R1(config-if)# exit
# R2
R2(config)# interface GigabitEthernet0/1
R2(config-if)# ip pim bidir-enable
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/2
R2(config-if)# ip pim bidir-enable
R2(config-if)# exit
# R3
R3(config)# interface GigabitEthernet0/1
R3(config-if)# ip pim bidir-enable
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/2
R3(config-if)# ip pim bidir-enable
R3(config-if)# exit
# R4
R4(config)# interface GigabitEthernet0/1
R4(config-if)# ip pim bidir-enable
R4(config-if)# exit
`
---------------------------------------------------------------------
‚úÖ Step 2: Configure static RP with BiDir
+ R1 acts as the RP and supports bidirectional traffic.
üìåconfiguration on R1
`R1(config)# interface Loopback0
R1(config-if)# ip address 10.10.10.10 255.255.255.255
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
# Set RP and enable BiDir for group 239.1.1.1
R1(config)# ip pim rp-address 10.10.10.10 bidir 239.1.1.1
`
---------------------------------------------------------------------
---------------------------------------------------------------------
**PIM-BIDIR with AUTO-RP**
 Configure R1 as RP Candidate & R2 as Mapping Agent
 `# R1 (RP Candidate)
R1(config)# interface Loopback0
R1(config-if)# ip address 10.10.10.10 255.255.255.255
R1(config-if)# exit
R1(config)# ip pim send-rp-announce Loopback0 scope 16 bidir 239.1.1.1
# R2 (Mapping Agent)
R2(config)# ip pim send-rp-discovery scope 16
`
Enable Auto-RP Listeners on All Other Routers
`R3(config)# ip pim autorp listener
R4(config)# ip pim autorp listener
`
---------------------------------------------------------------------
---------------------------------------------------------------------
PIM-BIDIR with BSR
- Configure R1 as RP Candidate & R3 as Bootstrap Router
`# R1 (RP Candidate)
R1(config)# interface Loopback0
R1(config-if)# ip address 10.10.10.10 255.255.255.255
R1(config-if)# exit
R1(config)# ip pim rp-candidate Loopback0 bidir 239.1.1.1
# R3 (Bootstrap Router)
R3(config)# interface Loopback0
R3(config-if)# ip address 3.3.3.3 255.255.255.255
R3(config-if)# exit
R3(config)# ip pim bsr-candidate Loopback0 0
`
---------------------------------------------------------------------


‚úÖ Step 3: Configure IGMP Join on R4 (Receiver)
+ To test multicast, we configure R4 to join a multicast group.
üìå Configuration on R4
`R4(config)# interface GigabitEthernet0/1
R4(config-if)# ip igmp join-group 239.1.1.1
R4(config-if)# exit
`

‚úÖ Step 4: Verification Commands
`show ip pim rp mapping
show ip mroute
show ip igmp groups
`

**üî• Summary**
‚úÖ PIM-BiDir allows efficient many-to-many multicast communication without the need for source registration.
‚úÖ Traffic flows bidirectionally through the RP, reducing overhead and making it ideal for financial data feeds, live events, and video conferencing.
‚úÖ Eliminates Shortest Path Tree (SPT) switching, ensuring fast convergence and optimal traffic forwarding.
üöÄ PIM-BiDir is best suited for scenarios where multiple sources and receivers need continuous multicast communication without interruptions!


4. PIM source-specific multicast (PIM-SSM): 
    - Supports IGMPv3 and allows receivers to specify both the multicast group and the specific source from which they want traffic.
    - Uses a shared tree approach with a specific source.
    - Eliminates the need for a Rendezvous Point (RP).
    - SSM requires IGMPv3
    - SSM uses a specific range of multicast addresses (232.0.0.0 through 232.255.255.255)
    - in SSM multicast path will move via shortest unicast path i.e no RPT or shared tree will be built

=======================================================
üìå Source-Specific Multicast (SSM) Overview
=======================================================
- Source-Specific Multicast (SSM) is a type of multicast that allows receivers to specify the exact source (sender) they want to receive traffic from. Unlike traditional multicast (PIM-SM or PIM-BiDir), SSM eliminates the need for an RP (Rendezvous Point) and relies on IGMPv3 or MLDv2 for source filtering.


üìç Why SSM?
------------
‚úÖ No RP required ‚Üí Reduces complexity.
‚úÖ Prevents unwanted traffic ‚Üí Receivers specify the source.
‚úÖ More secure & scalable ‚Üí No risk of malicious or unwanted sources.
‚úÖ Uses PIM Sparse Mode with SSM range (232.0.0.0/8 in IPv4).

üí° SSM Lab Setup
-------------------
üîπ Topology
    [ Source Server (S1) ]
             |
            (R1)
             |
            (R2)
             |
            (R3)
             |
        [ Receiver (PC) ]

- S1 sends multicast traffic to group 232.1.1.1.
- R3 (Receiver) joins multicast group using IGMPv3.
- R1, R2, and R3 use PIM Sparse Mode (SSM enabled).
- No RP is required.

‚úÖ Step 1: Enable PIM SSM on All Routers
----------------------------------------------
`R1(config)# ip pim ssm range 232.0.0.0/8
R2(config)# ip pim ssm range 232.0.0.0/8
R3(config)# ip pim ssm range 232.0.0.0/8
`
----------------------------------------------
----------------------------------------------
`R1(config)# ip pim ssm default
R2(config)# ip pim ssm default
R3(config)# ip pim ssm default
`
-----------------------------------------------
‚úÖ Step 2: Configure PIM on All Interfaces
`# R1
R1(config)# interface GigabitEthernet0/1  # Connected to Source (S1)
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
R1(config)# interface GigabitEthernet0/2  # Connected to R2
R1(config-if)# ip pim sparse-mode
R1(config-if)# exit
# R2
R2(config)# interface GigabitEthernet0/1  # Connected to R1
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
R2(config)# interface GigabitEthernet0/2  # Connected to R3
R2(config-if)# ip pim sparse-mode
R2(config-if)# exit
# R3
R3(config)# interface GigabitEthernet0/1  # Connected to R2
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
R3(config)# interface GigabitEthernet0/2  # Connected to PC (Receiver)
R3(config-if)# ip pim sparse-mode
R3(config-if)# exit
`
‚úÖ Step 3: Configure IGMPv3 Join on Receiver (R3)
`R3(config)# interface GigabitEthernet0/2
R3(config-if)# ip igmp version 3
R3(config-if)# ip igmp join-group 232.1.1.1 source 10.10.10.1
R3(config-if)# exit
`
- Receiver explicitly joins 232.1.1.1 from source 10.10.10.1.
- IGMPv3 required for source filtering.

‚úÖ Step 4: Configure Static Multicast Source (S1)
`S1(config)# interface GigabitEthernet0/1
S1(config-if)# ip address 10.10.10.1 255.255.255.0
S1(config-if)# exit
S1(config)# ip igmp version 3
S1(config)# ip multicast-routing
S1(config)# ip pim sparse-mode
`
‚úÖ Step 5: Verification Commands
`# Check SSM range configuration
show ip pim ssm range 
# Check IGMPv3 group membership on R3
show ip igmp groups 
# Check multicast routing table
show ip mroute 
# Check PIM neighbors
show ip pim neighbor
`

**üî• Now, SSM is configured!**
- Traffic flows only from the specific source.
- No need for an RP.
- Perfect for applications like IPTV & stock market feeds.



**NOTE:**
- the purpose of RP was to search of sources generation multicast traffic for groups